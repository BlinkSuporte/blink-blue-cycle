{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\victor.abrao\\\\Desktop\\\\source\\\\clientes-blue-cycle-ecommerce\\\\src\\\\pages\\\\Cart.js\";\nimport React, { useState, useEffect, createElement } from 'react'; // default\n\nimport Header from '../components/Header';\nimport Footer from '../components/Footer';\nimport Modal from \"react-bootstrap/Modal\";\nimport { Loader } from '../components/Loader/Loader';\nimport { formatMoney, disconnect, scrollToTop } from '../utils';\nimport { fetchCartItems, removeFromCart, updateCart } from '../services/cart-api';\nimport { fetchProductsBySuggestion } from '../services/products-api';\nimport ProductCard from '../components/Product/ProductCard';\nimport { arrOrigin } from '../constants';\nimport * as CartActions from '../store/actions/cart';\nimport { connect } from 'react-redux';\nimport { setItemSession } from '../utils';\n\nconst Swal = require('sweetalert2');\n\nconst Cart = ({\n  cartItems,\n  refreshCartFn\n}) => {\n  const [productsSuggestion, setProdutosSuggestion] = useState([]);\n  const [isLoadingSuggestion, setLoadingSuggestion] = useState(true);\n  const [isLoading, setLoading] = useState(true);\n  const [inputValue, setInputValue] = useState({}); // modal\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const showModal = () => {\n    setIsOpen(true);\n  };\n\n  const hideModal = () => {\n    setIsOpen(false);\n  }; // modal\n\n\n  const [qtd, setQtd] = useState(0);\n  const [amount, setAmount] = useState(0);\n  const [items, setItems] = useState([]);\n  const [itemsUnavailable, setItemsUnavailable] = useState([]);\n\n  const decrement = (idProduto, item, quantity) => {\n    if (quantity > 1) {\n      update(idProduto, item, quantity - 1);\n    }\n  };\n\n  const increment = (idProduto, item, quantity) => {\n    update(idProduto, item, quantity + 1);\n  };\n\n  const handleChange = e => {\n    setInputValue({\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleBlur = (idProduto, item, e) => {\n    e.preventDefault();\n    let quantity = inputValue[e.target.name];\n\n    if (parseInt(quantity) > 0) {\n      update(idProduto, item, quantity);\n    }\n  };\n\n  const update = (idProduto, item, quantity) => {\n    setLoading(true);\n    setAmount(0);\n    setQtd(0);\n    updateCart(idProduto, item, quantity).then(resultUpdate => {\n      if (resultUpdate.data.Codigo === 500) {\n        if (resultUpdate.data.CodigoInterno === 4) {\n          disconnect();\n          return;\n        } else {\n          alert(resultUpdate.data.Status);\n        }\n      }\n\n      localFetchItem();\n    });\n    /* Deixado somente 1 disconnect */\n    // .catch(reject => {\n    //     disconnect();\n    // })\n  }; // Scroll\n\n\n  useEffect(() => scrollToTop(), [isLoading]);\n\n  const removeItem = (idProduto, item) => {\n    setLoading(true);\n    setAmount(0);\n    setQtd(0);\n    removeFromCart(idProduto, item).then(result => {\n      localFetchItem();\n    });\n    /* Deixado somente 1 disconnect */\n    // .catch(reject => {\n    //     disconnect();\n    // })\n  }; // Load Data\n\n\n  useEffect(() => {\n    scrollToTop();\n    setLoading(true);\n    fetchCartItems().then(result => {\n      setItems(result.data.Data.Dados);\n      setQtd(result.data.Data.QuantidadeRegistrosTotal); //\n\n      const total = result.data.Data.Dados.reduce((acc, curr) => acc + curr.ValorTotalFinal, 0);\n      setAmount(total); //\n\n      const unavailable = result.data.Data.Dados.filter(newarr => newarr.Estoque === 0);\n\n      if (unavailable.length < 0) {\n        showModal();\n      }\n\n      setItemsUnavailable(unavailable);\n      setLoading(false); //\n\n      let inputArray = [];\n      result.data.Data.Dados.map(item => inputArray.push(item.Quantidade));\n      setInputValue(inputArray);\n    }).catch(reject => {\n      disconnect();\n    });\n    fetchProductsBySuggestion(5).then(result => {\n      if (result.data.Data) {\n        setProdutosSuggestion(result.data.Data.Dados);\n      }\n    }).then(result => setLoadingSuggestion(false));\n    /* Deixado somente 1 disconnect */\n    // .catch(reject => {\n    //     disconnect();\n    // })\n  }, [cartItems]);\n\n  const localFetchItem = () => {\n    fetchCartItems().then(result => {\n      setItemSession('_carrinho', JSON.stringify(result.data.Data));\n      refreshCartFn(result.data.Data);\n    }).then(result => setLoading(false)).catch(reject => {\n      disconnect();\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"meu-carrinho container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sect-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sect-titulo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"titulo h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 25\n    }\n  }, \"Meu carrinho\"), /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"titulo h6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 25\n    }\n  }, \"(\", qtd, \" Itens)\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tabela-items--wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }\n  }, !isLoading ? items.length > 0 ? /*#__PURE__*/React.createElement(\"table\", {\n    className: \"tabela tabela-items\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 41\n    }\n  }, \"Imagem\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 41\n    }\n  }, \"Nome do produto\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 41\n    }\n  }, \"Quantidade\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 41\n    }\n  }, \"Valor Unit\\xE1rio\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 41\n    }\n  }, \"Valor Total\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 41\n    }\n  }, \"A\\xE7\\xF5es\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 33\n    }\n  }, items.map((item, index) => /*#__PURE__*/React.createElement(\"tr\", {\n    key: `cart-item-${index}`,\n    className: `${item.Estoque < 1 && 'indisponivel'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"card-item--header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: item.LinkImagemLista,\n    alt: \"\",\n    className: \"img-card-produto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 49\n    }\n  })), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 49\n    }\n  }, item.Descricao), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 49\n    }\n  }, \"EAN: \", item.EAN), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"tabela-items--estoque\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 49\n    }\n  }, item.Estoque < 1 ? 'produto indisponível' : `${item.Estoque} disponíveis`)), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: \"form-adicionar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 49\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    disabled: `${item.Estoque < 1 ? 'disabled' : ''}`,\n    name: \"btn-item\",\n    className: \"btn form-adicionar--btn\",\n    onClick: () => decrement(item.idProduto, item.Item, item.Quantidade),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 53\n    }\n  }, \"-\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"number\",\n    disabled: `${item.Estoque < 1 ? 'disabled' : ''}`,\n    name: `quantity-${item.Item}` // usado o inputValue e nao o item.Quantidade para poder pegar valor do useState\n    ,\n    value: inputValue[index],\n    className: \"card-item--counter\",\n    maxLength: 4,\n    onChange: handleChange,\n    onBlur: e => handleBlur(item.idProduto, item.Item, e) // enter: e.which == 13\n    ,\n    onKeyPress: e => e.which == 13 ? handleBlur(item.idProduto, item.Item, e) : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 53\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    disabled: `${item.Estoque < 1 ? 'disabled' : ''}`,\n    name: \"btn-item\",\n    className: \"btn form-adicionar--btn\",\n    onClick: () => increment(item.idProduto, item.Item, item.Quantidade),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 53\n    }\n  }, \"+\"))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 45\n    }\n  }, \"R$ \", formatMoney(item.ValorFinal, 2, ',', '.')), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 45\n    }\n  }, \"R$ \", formatMoney(item.ValorTotalFinal, 2, ',', '.')), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => {\n      if (window.confirm('Deseja excluir esse item?')) removeItem(item.idProduto, item.Item);\n    },\n    className: \"btn btn--icon tabela-items--delete\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 49\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"icon icon-trash\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 225\n    }\n  }))))))) : /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 33\n    }\n  }, \"Carrinho vazio!\") : /*#__PURE__*/React.createElement(Loader, {\n    short: \"false\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sect-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 17\n    }\n  }, items.length > 0 && /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"titulo h3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 25\n    }\n  }, \"Valor Total \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"c-laranja arial-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 63\n    }\n  }, \" R$ \", formatMoney(amount, 2, ',', '.'), \" \")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sect-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 21\n    }\n  }, items.length > 0 && createElement('a', {\n    href: \"/checkout\",\n    className: \"btn btn--laranja btn--block btn--full btn--bold\"\n  }, \"Ir para o fechamento\"), createElement('a', {\n    href: \"/\",\n    className: \"btn btn-link btn--bold\"\n  }, \"Continuar Comprando\"))), /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"titulo h4 mais-produtos-titulo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 17\n    }\n  }, \"Produtos para incrementar seu pedido\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"conteudo_interno\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cards-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"overflow-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cards cards-produto cards-produto-width-5 mais-produtos-cards\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 29\n    }\n  }, !isLoadingSuggestion ? productsSuggestion.map(product => /*#__PURE__*/React.createElement(ProductCard, {\n    key: `cart-card-${product.idProduto}`,\n    product: product,\n    origin: arrOrigin['pagina_carrinho_incrementar'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 41\n    }\n  })) : /*#__PURE__*/React.createElement(Loader, {\n    short: \"false\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 41\n    }\n  })))))), /*#__PURE__*/React.createElement(Modal, {\n    show: isOpen,\n    className: \"modal modal-boleto fade\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-header_container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"./img/img-modal-indisponivel.png\",\n    alt: \"Imagem representativa de ma folha de papel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"titulo h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 25\n    }\n  }, \"Produto Indispon\\xEDvel\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 25\n    }\n  }, \"Desculpe, o(s) produto(s) acabaram nos nossos estoques.\")), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\",\n    onClick: hideModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"icon icon-times\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"ol\", {\n    className: \"lista-modal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 21\n    }\n  }, itemsUnavailable.map(product => /*#__PURE__*/React.createElement(\"li\", {\n    key: `unavailable-${product.idProduto}`,\n    className: \"lista-modal_item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 29\n    }\n  }, product.Descricao))))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 13\n    }\n  }));\n};\n\nconst mapStateToProps = state => ({\n  cartItems: state.cart.items\n});\n\nconst mapDispatchToProps = dispatch => ({\n  refreshCartFn: data => dispatch(CartActions.refreshCart(data))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Cart);","map":{"version":3,"sources":["C:/Users/victor.abrao/Desktop/source/clientes-blue-cycle-ecommerce/src/pages/Cart.js"],"names":["React","useState","useEffect","createElement","Header","Footer","Modal","Loader","formatMoney","disconnect","scrollToTop","fetchCartItems","removeFromCart","updateCart","fetchProductsBySuggestion","ProductCard","arrOrigin","CartActions","connect","setItemSession","Swal","require","Cart","cartItems","refreshCartFn","productsSuggestion","setProdutosSuggestion","isLoadingSuggestion","setLoadingSuggestion","isLoading","setLoading","inputValue","setInputValue","isOpen","setIsOpen","showModal","hideModal","qtd","setQtd","amount","setAmount","items","setItems","itemsUnavailable","setItemsUnavailable","decrement","idProduto","item","quantity","update","increment","handleChange","e","target","name","value","handleBlur","preventDefault","parseInt","then","resultUpdate","data","Codigo","CodigoInterno","alert","Status","localFetchItem","removeItem","result","Data","Dados","QuantidadeRegistrosTotal","total","reduce","acc","curr","ValorTotalFinal","unavailable","filter","newarr","Estoque","length","inputArray","map","push","Quantidade","catch","reject","JSON","stringify","index","LinkImagemLista","Descricao","EAN","Item","which","ValorFinal","window","confirm","href","className","product","mapStateToProps","state","cart","mapDispatchToProps","dispatch","refreshCart"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createElement } from 'react';\r\n// default\r\nimport Header from '../components/Header';\r\nimport Footer from '../components/Footer';\r\n\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport { Loader } from '../components/Loader/Loader';\r\nimport { formatMoney, disconnect, scrollToTop } from '../utils';\r\nimport { fetchCartItems, removeFromCart, updateCart } from '../services/cart-api';\r\nimport { fetchProductsBySuggestion } from '../services/products-api';\r\nimport ProductCard from '../components/Product/ProductCard';\r\nimport { arrOrigin } from '../constants';\r\nimport * as CartActions from '../store/actions/cart'\r\nimport { connect } from 'react-redux';\r\nimport { setItemSession } from '../utils';\r\n\r\nconst Swal = require('sweetalert2');\r\n\r\n\r\nconst Cart = ({ cartItems, refreshCartFn }) => {\r\n    const [productsSuggestion, setProdutosSuggestion] = useState([]);\r\n    const [isLoadingSuggestion, setLoadingSuggestion] = useState(true);\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [inputValue, setInputValue] = useState({});\r\n\r\n    // modal\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    const showModal = () => {\r\n        setIsOpen(true);\r\n    };\r\n\r\n    const hideModal = () => {\r\n        setIsOpen(false);\r\n    };\r\n    // modal\r\n\r\n    const [qtd, setQtd] = useState(0);\r\n    const [amount, setAmount] = useState(0);\r\n    const [items, setItems] = useState([]);\r\n    const [itemsUnavailable, setItemsUnavailable] = useState([]);\r\n\r\n    const decrement = (idProduto, item, quantity) => {\r\n        if (quantity > 1) {\r\n            update(idProduto, item, quantity - 1);\r\n        }\r\n    }\r\n\r\n    const increment = (idProduto, item, quantity) => {\r\n        update(idProduto, item, quantity + 1);\r\n    }\r\n\r\n    const handleChange = (e) => {\r\n        setInputValue({ [e.target.name]: e.target.value });\r\n    }\r\n\r\n    const handleBlur = (idProduto, item, e) => {\r\n        e.preventDefault();\r\n\r\n        let quantity = inputValue[e.target.name];\r\n\r\n        if (parseInt(quantity) > 0) {\r\n            update(idProduto, item, quantity);\r\n        }\r\n    }\r\n\r\n    const update = (idProduto, item, quantity) => {\r\n        setLoading(true);\r\n        setAmount(0);\r\n        setQtd(0);\r\n\r\n        updateCart(idProduto, item, quantity)\r\n            .then(resultUpdate => {\r\n                if (resultUpdate.data.Codigo === 500) {\r\n                    if (resultUpdate.data.CodigoInterno === 4) {\r\n                        disconnect()\r\n                        return\r\n                    } else {\r\n                        alert(resultUpdate.data.Status);\r\n                    }\r\n                }\r\n\r\n                localFetchItem()\r\n            })\r\n        /* Deixado somente 1 disconnect */\r\n        // .catch(reject => {\r\n        //     disconnect();\r\n        // })\r\n    }\r\n\r\n    // Scroll\r\n    useEffect(() => scrollToTop(), [isLoading]);\r\n\r\n    const removeItem = (idProduto, item) => {\r\n        setLoading(true);\r\n        setAmount(0);\r\n        setQtd(0);\r\n\r\n        removeFromCart(idProduto, item)\r\n            .then(result => {\r\n                localFetchItem()\r\n            })\r\n        /* Deixado somente 1 disconnect */\r\n        // .catch(reject => {\r\n        //     disconnect();\r\n        // })\r\n    }\r\n\r\n    // Load Data\r\n    useEffect(() => {\r\n        scrollToTop();\r\n\r\n        setLoading(true);\r\n\r\n        fetchCartItems()\r\n            .then(result => {\r\n                setItems(result.data.Data.Dados)\r\n                setQtd(result.data.Data.QuantidadeRegistrosTotal)\r\n\r\n                //\r\n                const total = result.data.Data.Dados.reduce((acc, curr) => acc + curr.ValorTotalFinal, 0);\r\n                setAmount(total)\r\n\r\n                //\r\n                const unavailable = result.data.Data.Dados.filter(newarr => newarr.Estoque === 0);\r\n                if (unavailable.length < 0) {\r\n                    showModal()\r\n                }\r\n                setItemsUnavailable(unavailable);\r\n\r\n                setLoading(false);\r\n\r\n                //\r\n                let inputArray = [];\r\n                result.data.Data.Dados.map(item => inputArray.push(item.Quantidade));\r\n                setInputValue(inputArray);\r\n            })\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n\r\n        fetchProductsBySuggestion(5)\r\n            .then(result => {\r\n                if (result.data.Data) {\r\n                    setProdutosSuggestion(result.data.Data.Dados)\r\n                }\r\n            })\r\n            .then(result => setLoadingSuggestion(false))\r\n        /* Deixado somente 1 disconnect */\r\n        // .catch(reject => {\r\n        //     disconnect();\r\n        // })\r\n\r\n    }, [cartItems]);\r\n\r\n    const localFetchItem = () => {\r\n        fetchCartItems()\r\n            .then(result => {\r\n                setItemSession('_carrinho', JSON.stringify(result.data.Data))\r\n                refreshCartFn(result.data.Data)\r\n            })\r\n            .then(result => setLoading(false))\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Header />\r\n            <section className=\"meu-carrinho container\">\r\n                <div className=\"sect-header\">\r\n                    <div className=\"sect-titulo\">\r\n                        <h2 className=\"titulo h2\">Meu carrinho</h2>\r\n                        <h6 className=\"titulo h6\">({qtd} Itens)</h6>\r\n                    </div>\r\n                </div>\r\n                <div className=\"tabela-items--wrapper\">\r\n                    {!isLoading ? (\r\n                        items.length > 0 ? (\r\n                            <table className=\"tabela tabela-items\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th>Imagem</th>\r\n                                        <th>Nome do produto</th>\r\n                                        <th>Quantidade</th>\r\n                                        <th>Valor Unitário</th>\r\n                                        <th>Valor Total</th>\r\n                                        <th>Ações</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {items.map((item, index) => (\r\n                                        <tr key={`cart-item-${index}`} className={`${item.Estoque < 1 && 'indisponivel'}`}>\r\n                                            <td className=\"card-item--header\">\r\n                                                <img src={item.LinkImagemLista} alt=\"\" className=\"img-card-produto\" />\r\n                                            </td>\r\n                                            <td>\r\n                                                <p>{item.Descricao}</p>\r\n                                                <p>EAN: {item.EAN}</p>\r\n                                                <p className=\"tabela-items--estoque\">\r\n                                                    {item.Estoque < 1\r\n                                                        ? 'produto indisponível'\r\n                                                        : `${item.Estoque} disponíveis`\r\n                                                    }\r\n                                                </p>\r\n                                            </td>\r\n                                            <td>\r\n                                                <form className=\"form-adicionar\">\r\n                                                    <button\r\n                                                        type=\"button\"\r\n                                                        disabled={`${item.Estoque < 1 ? 'disabled' : ''}`}\r\n                                                        name=\"btn-item\"\r\n                                                        className=\"btn form-adicionar--btn\"\r\n                                                        onClick={() => decrement(item.idProduto, item.Item, item.Quantidade)}>-</button>\r\n                                                    <input\r\n                                                        type=\"number\"\r\n                                                        disabled={`${item.Estoque < 1 ? 'disabled' : ''}`}\r\n                                                        name={`quantity-${item.Item}`}\r\n                                                        // usado o inputValue e nao o item.Quantidade para poder pegar valor do useState\r\n                                                        value={inputValue[index]}\r\n                                                        className=\"card-item--counter\"\r\n                                                        maxLength={4}\r\n                                                        onChange={handleChange}\r\n                                                        onBlur={(e) => handleBlur(item.idProduto, item.Item, e)}\r\n                                                        // enter: e.which == 13\r\n                                                        onKeyPress={(e) => e.which == 13 ? handleBlur(item.idProduto, item.Item, e) : ''}\r\n                                                    />\r\n                                                    <button\r\n                                                        type=\"button\"\r\n                                                        disabled={`${item.Estoque < 1 ? 'disabled' : ''}`}\r\n                                                        name=\"btn-item\"\r\n                                                        className=\"btn form-adicionar--btn\"\r\n                                                        onClick={() => increment(item.idProduto, item.Item, item.Quantidade)}>+</button>\r\n                                                </form>\r\n                                            </td>\r\n                                            <td>R$ {formatMoney(item.ValorFinal, 2, ',', '.')}</td>\r\n                                            <td>R$ {formatMoney(item.ValorTotalFinal, 2, ',', '.')}</td>\r\n                                            <td className=\"text-center\">\r\n                                                <button type=\"button\" onClick={() => { if (window.confirm('Deseja excluir esse item?')) removeItem(item.idProduto, item.Item) }} className=\"btn btn--icon tabela-items--delete\"><span className=\"icon icon-trash\"></span></button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        ) : (\r\n                                <span>Carrinho vazio!</span>\r\n                            )\r\n                    ) : (\r\n                            <Loader short=\"false\" />\r\n                        )}\r\n                </div>\r\n                <div className=\"sect-footer\">\r\n                    {items.length > 0 &&\r\n                        <h3 className=\"titulo h3\">Valor Total <span className=\"c-laranja arial-bold\"> R$ {formatMoney(amount, 2, ',', '.')} </span></h3>\r\n                    }\r\n                    <div className=\"sect-btn\">\r\n                        {items.length > 0 &&\r\n                            createElement('a', { href: \"/checkout\", className: \"btn btn--laranja btn--block btn--full btn--bold\" }, \"Ir para o fechamento\")\r\n                        }\r\n                        {createElement('a', { href: \"/\", className: \"btn btn-link btn--bold\" }, \"Continuar Comprando\")}\r\n                        {/* <a href=\"/\" className=\"btn btn-link btn--bold\">Continuar Comprando</a> */}\r\n                    </div>\r\n                </div>\r\n\r\n                <h4 className=\"titulo h4 mais-produtos-titulo\">Produtos para incrementar seu pedido</h4>\r\n                <div className=\"conteudo_interno\">\r\n                    <div className=\"cards-container\">\r\n                        <div className=\"overflow-auto\">\r\n                            <div className=\"cards cards-produto cards-produto-width-5 mais-produtos-cards\">\r\n                                {!isLoadingSuggestion ? (\r\n                                    productsSuggestion.map(product =>\r\n                                        <ProductCard\r\n                                            key={`cart-card-${product.idProduto}`}\r\n                                            product={product}\r\n                                            origin={arrOrigin['pagina_carrinho_incrementar']}\r\n                                        />\r\n                                    )\r\n                                ) : (\r\n                                        <Loader short=\"false\" />\r\n                                    )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* <!-- Modal --> */}\r\n            <Modal show={isOpen} className=\"modal modal-boleto fade\">\r\n                <Modal.Header>\r\n                    <div className=\"modal-header_container\">\r\n                        <img src=\"./img/img-modal-indisponivel.png\" alt=\"Imagem representativa de ma folha de papel\" />\r\n                        <h2 className=\"titulo h2\">Produto Indisponível</h2>\r\n                        <p>Desculpe, o(s) produto(s) acabaram nos nossos estoques.</p>\r\n                    </div>\r\n                    <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={hideModal}>\r\n                        <i className=\"icon icon-times\"></i>\r\n                    </button>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <ol className=\"lista-modal\">\r\n                        {itemsUnavailable.map(product => (\r\n                            <li key={`unavailable-${product.idProduto}`} className=\"lista-modal_item\">{product.Descricao}</li>\r\n                        ))}\r\n                    </ol>\r\n                </Modal.Body>\r\n            </Modal>\r\n\r\n            <Footer />\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    cartItems: state.cart.items\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    refreshCartFn: (data) => dispatch(CartActions.refreshCart(data))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Cart);"]},"metadata":{},"sourceType":"module"}