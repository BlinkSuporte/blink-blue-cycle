{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\victor.abrao\\\\Desktop\\\\source\\\\clientes-blue-cycle-ecommerce\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useRef,useEffect,createElement}from'react';import Header from'../components/Header';import Footer from'../components/Footer';import Manufacturer from'../components/SideBar/Manufacturer';import Category from'../components/SideBar/Category';import{formatMoney,disconnect,setItemSession,getItemSession}from'../utils';import{fetchProductsById,fetchProductsBySuggestion}from'../services/products-api';import{Loader}from'../components/Loader/Loader';import ProductCard from'../components/Product/ProductCard';import{arrOrigin}from'../constants';import{addToCart,fetchCartItems,updateCart}from'../services/cart-api';import*as CartActions from'../store/actions/cart';import{connect}from'react-redux';var Swal=require('sweetalert2');var Product=function Product(_ref){var match=_ref.match,origin=_ref.origin,refreshCartFn=_ref.refreshCartFn;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoadingSuggestion=_useState4[0],setLoadingSuggestion=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),product=_useState6[0],setProduct=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),productsSuggestion=_useState8[0],setProdutosSuggestion=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),adding=_useState10[0],setAdding=_useState10[1];// Props\nvar idProduto=match.params.id;var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),quantity=_useState12[0],setQuantity=_useState12[1];var decrement=function decrement(){return setQuantity(function(q){return isNaN(q)||q<2?1:q-1;});};var increment=function increment(){return setQuantity(function(q){return q>=0?q+1:1;});};var handleChange=function handleChange(e){if(parseInt(e.target.value)>0){setQuantity(parseInt(e.target.value));}else{setQuantity();}};// Load Data\nuseEffect(function(){fetchProductsById(idProduto).then(function(result){setProduct(result.data.Data.Dados[0]);}).then(function(result){return setLoading(false);}).catch(function(reject){disconnect();});},[]);useEffect(function(){fetchProductsBySuggestion(4).then(function(result){setProdutosSuggestion(result.data.Data.Dados);}).then(function(result){return setLoadingSuggestion(false);}).catch(function(reject){disconnect();});},[]);var handleAddToCart=function handleAddToCart(e){e.preventDefault();document.getElementById(\"botaoRoxoPrincipal\").setAttribute(\"disabled\",\"disabled\");;var intQuantity=parseInt(quantity);if(isNaN(intQuantity)||intQuantity<1){alert(\"Insira uma quantidade válida para o produto!\");return false;}setAdding(true);buttonActionDisabled(e);// filtro para ver se produto já está no carrinho\nvar get=getItemSession('_carrinho');var cartItems=JSON.parse(get);var item=cartItems.Dados.filter(function(item){return item.idProduto===product.idProduto;});var time=2000;if(item.length>0){var newQuantity=intQuantity+parseInt(item[0].Quantidade);updateCart(product.idProduto,item[0].Item,newQuantity).then(function(resultUpdate){if(resultUpdate.data.Codigo===500){alert(resultUpdate.data.Status);setAdding(false);time=0;}else{fetchCartItems().then(function(result){if(result.data.Data.Dados.length>0){setItemSession('_carrinho',JSON.stringify(result.data.Data));refreshCartFn(result.data.Data);}setAdding(false);}).catch(function(reject){disconnect();});}}).catch(function(reject){disconnect();});}else{addToCart(product.idProduto,intQuantity,arrOrigin['pagina_produto']).then(function(resultAdd){if(resultAdd.data.Codigo===500){if(resultAdd.data.CodigoInterno==4){disconnect();}else{alert(resultAdd.data.Status);setAdding(false);time=0;}}else{fetchCartItems().then(function(result){if(result.data.Data.Dados.length>0){setItemSession('_carrinho',JSON.stringify(result.data.Data));refreshCartFn(result.data.Data);}setAdding(false);}).catch(function(reject){disconnect();});}}).catch(function(reject){disconnect();});}buttonActionEnabled(e);};var buttonActionDisabled=function buttonActionDisabled(e){e.target.disabled=true;};var buttonActionEnabled=function buttonActionEnabled(e){e.target.disabled=false;};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"section\",{className:\"conteudo_interno conteudo_padrao container produtos-detalhe\"},/*#__PURE__*/React.createElement(\"div\",{className:\"filtro-sticky d-none d-lg-block\"},/*#__PURE__*/React.createElement(Manufacturer,null),/*#__PURE__*/React.createElement(Category,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"produtos-detalhe--wrapper\"},!isLoading?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"sect-header\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"titulo h2\"},\"Produtos - \",product.Descricao),/*#__PURE__*/React.createElement(\"hr\",null)),/*#__PURE__*/React.createElement(\"div\",{className:\"produtos-detalhe--conteudo\"},/*#__PURE__*/React.createElement(\"div\",{className:\"produtos-detalhe--img\"},/*#__PURE__*/React.createElement(\"img\",{src:product.LinkImagemDetalhe,alt:\"\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"produtos-detalhe--body\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"titulo h4\"},product.Descricao),/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--codigo\"},\"EAN: \",product.EAN),/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--codigo\"},\"C\\xF3digo: \",product.CodigoProduto),/*#__PURE__*/React.createElement(\"div\",{className:\"produtos-detalhe--info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"misc\"},/*#__PURE__*/React.createElement(\"p\",null,\"Embalagem\"),/*#__PURE__*/React.createElement(\"p\",null,product.Embalagem)),/*#__PURE__*/React.createElement(\"div\",{className:\"misc\"},/*#__PURE__*/React.createElement(\"p\",null,\"Unidade(s)\"),/*#__PURE__*/React.createElement(\"p\",null,product.UnidadesPorCaixa))),product.PossuiPrecoPromocional?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--valor--de\"},/*#__PURE__*/React.createElement(\"strike\",null,\"R$ \",formatMoney(product.PrecoUnitario,2,',','.')),\" \",/*#__PURE__*/React.createElement(\"small\",null,\"unidade\")),/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--valor--por\"},\"R$ \",formatMoney(product.PrecoPromocionalUnitario,2,',','.'),\" \",/*#__PURE__*/React.createElement(\"small\",null,\"unidade\")),/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--valor-total\"},/*#__PURE__*/React.createElement(\"b\",null,\"Total: de \",/*#__PURE__*/React.createElement(\"strike\",null,\"R$ \",formatMoney(product.Preco,2,',','.')),\" por R$ \",formatMoney(product.PrecoPromocional,2,',','.')))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--valor\"},\"R$ \",formatMoney(product.PrecoUnitario,2,',','.'),\" \",/*#__PURE__*/React.createElement(\"small\",null,\"unidade\")),/*#__PURE__*/React.createElement(\"p\",{className:\"produtos-detalhe--valor-total\"},/*#__PURE__*/React.createElement(\"b\",null,\"Total R$ \",formatMoney(product.Preco,2,',','.')))),/*#__PURE__*/React.createElement(\"div\",{className:\"produtos-detalhe--estoque\"},product.Estoque>0?\"\".concat(product.Estoque,\" dispon\\xEDveis\"):/*#__PURE__*/React.createElement(\"span\",{className:\"badge badge-black-white\"},\"Produto indispon\\xEDvel\")),/*#__PURE__*/React.createElement(\"hr\",null),product.Estoque>0&&/*#__PURE__*/React.createElement(\"form\",{className:\"form-adicionar\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",name:\"btn-item\",className:\"btn form-adicionar--btn\",onClick:decrement},\"-\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",name:\"quantity\",value:quantity,className:\"card-item--counter\",onChange:handleChange,maxLength:4}),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",name:\"btn-item\",className:\"btn form-adicionar--btn\",onClick:increment},\"+\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:handleAddToCart,class:\"btn btn--sm btn--roxo btn--bold \".concat(adding&&'active'),id:\"botaoRoxoPrincipal\"},adding?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"spinner-border spinner-border-sm text-light\"}),\" Adicionando\"):'Adicionar'))))):/*#__PURE__*/React.createElement(Loader,{short:\"false\"}),/*#__PURE__*/React.createElement(\"h4\",{className:\"titulo h4 mais-produtos-titulo\"},\"Produtos para incrementar seu pedido\"),/*#__PURE__*/React.createElement(\"div\",{className:\"cards-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"overflow-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"cards cards-produto mais-produtos-4-cards cards-produto-width-4\"},!isLoadingSuggestion?productsSuggestion.map(function(product){return/*#__PURE__*/React.createElement(ProductCard,{key:\"product-detail-card-\".concat(product.idProduto),product:product,origin:arrOrigin['pagina_produto_incrementar']});}):/*#__PURE__*/React.createElement(Loader,{short:\"false\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"sect-footer align-items-start\"},createElement('a',{href:'/',className:'btn btn--cinza btn--block btn-full btn--bold'},\"Voltar\")))),/*#__PURE__*/React.createElement(Footer,null));};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{refreshCartFn:function refreshCartFn(data){return dispatch(CartActions.refreshCart(data));}};};export default connect('',mapDispatchToProps)(Product);","map":{"version":3,"sources":["C:/Users/victor.abrao/Desktop/source/clientes-blue-cycle-ecommerce/src/pages/Product.js"],"names":["React","useState","useRef","useEffect","createElement","Header","Footer","Manufacturer","Category","formatMoney","disconnect","setItemSession","getItemSession","fetchProductsById","fetchProductsBySuggestion","Loader","ProductCard","arrOrigin","addToCart","fetchCartItems","updateCart","CartActions","connect","Swal","require","Product","match","origin","refreshCartFn","isLoading","setLoading","isLoadingSuggestion","setLoadingSuggestion","product","setProduct","productsSuggestion","setProdutosSuggestion","adding","setAdding","idProduto","params","id","quantity","setQuantity","decrement","q","isNaN","increment","handleChange","e","parseInt","target","value","then","result","data","Data","Dados","catch","reject","handleAddToCart","preventDefault","document","getElementById","setAttribute","intQuantity","alert","buttonActionDisabled","get","cartItems","JSON","parse","item","filter","time","length","newQuantity","Quantidade","Item","resultUpdate","Codigo","Status","stringify","resultAdd","CodigoInterno","buttonActionEnabled","disabled","Descricao","LinkImagemDetalhe","EAN","CodigoProduto","Embalagem","UnidadesPorCaixa","PossuiPrecoPromocional","PrecoUnitario","PrecoPromocionalUnitario","Preco","PrecoPromocional","Estoque","map","href","className","mapDispatchToProps","dispatch","refreshCart"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect, createElement } from 'react';\r\nimport Header from '../components/Header';\r\nimport Footer from '../components/Footer';\r\nimport Manufacturer from '../components/SideBar/Manufacturer';\r\nimport Category from '../components/SideBar/Category';\r\nimport { formatMoney, disconnect, setItemSession, getItemSession } from '../utils';\r\nimport {\r\n    fetchProductsById,\r\n    fetchProductsBySuggestion\r\n} from '../services/products-api';\r\nimport { Loader } from '../components/Loader/Loader';\r\nimport ProductCard from '../components/Product/ProductCard';\r\nimport { arrOrigin } from '../constants';\r\nimport { addToCart, fetchCartItems, updateCart } from '../services/cart-api';\r\nimport * as CartActions from '../store/actions/cart'\r\nimport { connect } from 'react-redux';\r\nconst Swal = require('sweetalert2');\r\n\r\nconst Product = ({ match, origin, refreshCartFn }) => {\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [isLoadingSuggestion, setLoadingSuggestion] = useState(true);\r\n    const [product, setProduct] = useState('');\r\n    const [productsSuggestion, setProdutosSuggestion] = useState([]);\r\n    const [adding, setAdding] = useState(false)\r\n\r\n    // Props\r\n    const idProduto = match.params.id;\r\n\r\n    const [quantity, setQuantity] = useState(1)\r\n\r\n    const decrement = () => setQuantity(q => isNaN(q) || q < 2 ? 1 : q - 1);\r\n    const increment = () => setQuantity(q => q >= 0 ? q + 1 : 1);\r\n\r\n    const handleChange = (e) => {\r\n        if (parseInt(e.target.value) > 0) {\r\n            setQuantity(parseInt(e.target.value));\r\n        } else {\r\n            setQuantity();\r\n        }\r\n    }\r\n\r\n    // Load Data\r\n    useEffect(() => {\r\n        fetchProductsById(idProduto)\r\n            .then(result => {\r\n                setProduct(result.data.Data.Dados[0])\r\n            })\r\n            .then(result => setLoading(false))\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        fetchProductsBySuggestion(4)\r\n            .then(result => {\r\n                setProdutosSuggestion(result.data.Data.Dados)\r\n            })\r\n            .then(result => setLoadingSuggestion(false))\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n    }, [])\r\n\r\n    const handleAddToCart = (e) => {\r\n        e.preventDefault();\r\n        document.getElementById(\"botaoRoxoPrincipal\").setAttribute(\"disabled\",\"disabled\");;\r\n        const intQuantity = parseInt(quantity);\r\n\r\n        if (isNaN(intQuantity) || intQuantity < 1) {\r\n            alert(\"Insira uma quantidade válida para o produto!\");\r\n            return false;\r\n        }\r\n\r\n        setAdding(true);\r\n\r\n        buttonActionDisabled(e);\r\n\r\n        // filtro para ver se produto já está no carrinho\r\n        const get = getItemSession('_carrinho');\r\n        const cartItems = JSON.parse(get);\r\n\r\n        const item = cartItems.Dados.filter(item => { return item.idProduto === product.idProduto })\r\n\r\n        let time = 2000;\r\n\r\n        if (item.length > 0) {\r\n            const newQuantity = intQuantity + parseInt(item[0].Quantidade)\r\n\r\n            updateCart(product.idProduto, item[0].Item, newQuantity)\r\n                .then(resultUpdate => {\r\n                    if (resultUpdate.data.Codigo === 500) {\r\n                        alert(resultUpdate.data.Status);\r\n\t\t\t\t\t\tsetAdding(false);\r\n                        time = 0;\r\n                    } else {\r\n                        fetchCartItems()\r\n                            .then(result => {\r\n                                if (result.data.Data.Dados.length > 0) {\r\n                                    setItemSession('_carrinho', JSON.stringify(result.data.Data))\r\n                                    refreshCartFn(result.data.Data)\r\n                                }   \r\n\t\t\t\t\t\t\t\tsetAdding(false);\r\n                            })\r\n                            .catch(reject => {\r\n                                disconnect();\r\n                            })\r\n\r\n                    }\r\n                })\r\n                .catch(reject => {\r\n                    disconnect();\r\n                })\r\n\r\n        } else {\r\n            addToCart(product.idProduto, intQuantity, arrOrigin['pagina_produto'])\r\n                .then(resultAdd => {\r\n                    if (resultAdd.data.Codigo === 500) {\r\n                        if (resultAdd.data.CodigoInterno == 4) {\r\n                            disconnect()\r\n                        } else {\r\n                            alert(resultAdd.data.Status);\r\n\t\t\t\t\t\t\tsetAdding(false);\r\n                            time = 0;\r\n                        }\r\n                    } else {\r\n                        fetchCartItems()\r\n                            .then(result => {\r\n                                if (result.data.Data.Dados.length > 0) {\r\n                                    setItemSession('_carrinho', JSON.stringify(result.data.Data))\r\n                                    refreshCartFn(result.data.Data)                                    \r\n                                }\r\n\t\t\t\t\t\t\t\tsetAdding(false);\r\n                            })\r\n                            .catch(reject => {\r\n                                disconnect();\r\n                            })\r\n                    }\r\n                })\r\n                .catch(reject => {\r\n                    disconnect();\r\n                })\r\n        }\r\n\r\n\r\n        buttonActionEnabled(e);\r\n    }\r\n\r\n    const buttonActionDisabled = (e) => {\r\n        e.target.disabled = true;\r\n    }\r\n    const buttonActionEnabled = (e) => {\r\n        e.target.disabled = false;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Header />\r\n            <section className=\"conteudo_interno conteudo_padrao container produtos-detalhe\">\r\n                <div className=\"filtro-sticky d-none d-lg-block\">\r\n                    <Manufacturer />\r\n                    <Category />\r\n                </div>\r\n                <div className=\"produtos-detalhe--wrapper\">\r\n                    {!isLoading ? (\r\n                        <>\r\n                            <div className=\"sect-header\">\r\n                                <h4 className=\"titulo h2\">Produtos - {product.Descricao}</h4>\r\n                                <hr />\r\n                            </div>\r\n\r\n                            <div className=\"produtos-detalhe--conteudo\">\r\n                                <div className=\"produtos-detalhe--img\">\r\n                                    <img src={product.LinkImagemDetalhe} alt=\"\" />\r\n                                </div>\r\n                                <div className=\"produtos-detalhe--body\">\r\n                                    <h4 className=\"titulo h4\">{product.Descricao}</h4>\r\n                                    <p className=\"produtos-detalhe--codigo\">EAN: {product.EAN}</p>\r\n                                    <p className=\"produtos-detalhe--codigo\">Código: {product.CodigoProduto}</p>\r\n                                    <div className=\"produtos-detalhe--info\">\r\n                                        <div className=\"misc\">\r\n                                            <p>Embalagem</p>\r\n                                            <p>{product.Embalagem}</p>\r\n                                        </div>\r\n                                        <div className=\"misc\">\r\n                                            <p>Unidade(s)</p>\r\n                                            <p>{product.UnidadesPorCaixa}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    {product.PossuiPrecoPromocional\r\n                                        ?\r\n                                        <>\r\n                                            <p className=\"produtos-detalhe--valor--de\"><strike>R$ {formatMoney(product.PrecoUnitario, 2, ',', '.')}</strike> <small>unidade</small></p>\r\n                                            <p className=\"produtos-detalhe--valor--por\">R$ {formatMoney(product.PrecoPromocionalUnitario, 2, ',', '.')} <small>unidade</small></p>\r\n                                            <p className=\"produtos-detalhe--valor-total\"><b>Total: de <strike>R$ {formatMoney(product.Preco, 2, ',', '.')}</strike> por R$ {formatMoney(product.PrecoPromocional, 2, ',', '.')}</b></p>\r\n                                        </>\r\n                                        :\r\n                                        <>\r\n                                            <p className=\"produtos-detalhe--valor\">R$ {formatMoney(product.PrecoUnitario, 2, ',', '.')} <small>unidade</small></p>\r\n                                            <p className=\"produtos-detalhe--valor-total\"><b>Total R$ {formatMoney(product.Preco, 2, ',', '.')}</b></p>\r\n                                        </>\r\n                                    }\r\n                                    <div className=\"produtos-detalhe--estoque\">{product.Estoque > 0 ? `${product.Estoque} disponíveis` : <span className=\"badge badge-black-white\">Produto indisponível</span>}</div>\r\n                                    <hr />\r\n                                    {product.Estoque > 0 &&\r\n                                        <form className=\"form-adicionar\">\r\n                                            <button type=\"button\" name=\"btn-item\" className=\"btn form-adicionar--btn\" onClick={decrement}>-</button>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                name=\"quantity\"\r\n                                                value={quantity}\r\n                                                className=\"card-item--counter\"\r\n                                                onChange={handleChange}\r\n                                                maxLength={4}\r\n                                            />\r\n                                            <button type=\"button\" name=\"btn-item\" className=\"btn form-adicionar--btn\" onClick={increment}>+</button>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={handleAddToCart}\r\n                                                class={`btn btn--sm btn--roxo btn--bold ${adding && 'active'}`}\r\n                                                id=\"botaoRoxoPrincipal\"\r\n                                            >\r\n                                                {adding\r\n                                                    ? <><div className=\"spinner-border spinner-border-sm text-light\"></div> Adicionando</>\r\n                                                    : 'Adicionar'\r\n                                                }\r\n                                            </button>\r\n                                        </form>\r\n                                    }\r\n                                </div>\r\n                            </div>\r\n                        </>\r\n                    ) : (\r\n                            <Loader short=\"false\" />\r\n                        )}\r\n\r\n                    <h4 className=\"titulo h4 mais-produtos-titulo\">Produtos para incrementar seu pedido</h4>\r\n                    <div className=\"cards-container\">\r\n                        <div className=\"overflow-auto\">\r\n                            <div className=\"cards cards-produto mais-produtos-4-cards cards-produto-width-4\">\r\n                                {!isLoadingSuggestion ? (\r\n                                    productsSuggestion.map(product =>\r\n                                        <ProductCard\r\n                                            key={`product-detail-card-${product.idProduto}`}\r\n                                            product={product}\r\n                                            origin={arrOrigin['pagina_produto_incrementar']}\r\n                                        />\r\n                                    )\r\n                                ) : (\r\n                                        <Loader short=\"false\" />\r\n                                    )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"sect-footer align-items-start\">\r\n                        {createElement('a', { href: '/', className: 'btn btn--cinza btn--block btn-full btn--bold' }, \"Voltar\")}\r\n                    </div>\r\n                </div>\r\n            </section>\r\n            <Footer />\r\n        </>\r\n    );\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    refreshCartFn: (data) => dispatch(CartActions.refreshCart(data))\r\n})\r\n\r\nexport default connect('', mapDispatchToProps)(Product); "]},"metadata":{},"sourceType":"module"}