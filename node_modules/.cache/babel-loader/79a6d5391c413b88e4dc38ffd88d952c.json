{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\victor.abrao\\\\Desktop\\\\source\\\\clientes-blue-cycle-ecommerce\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _slicedToArray from\"C:\\\\Users\\\\victor.abrao\\\\Desktop\\\\source\\\\clientes-blue-cycle-ecommerce\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createElement}from'react';// default\nimport Header from'../components/Header';import Footer from'../components/Footer';import Modal from\"react-bootstrap/Modal\";import{Loader}from'../components/Loader/Loader';import{formatMoney,disconnect,scrollToTop}from'../utils';import{fetchCartItems,removeFromCart,updateCart}from'../services/cart-api';import{fetchProductsBySuggestion}from'../services/products-api';import ProductCard from'../components/Product/ProductCard';import{arrOrigin}from'../constants';import*as CartActions from'../store/actions/cart';import{connect}from'react-redux';import{setItemSession}from'../utils';var Swal=require('sweetalert2');var Cart=function Cart(_ref){var cartItems=_ref.cartItems,refreshCartFn=_ref.refreshCartFn;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),productsSuggestion=_useState2[0],setProdutosSuggestion=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoadingSuggestion=_useState4[0],setLoadingSuggestion=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setLoading=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),inputValue=_useState8[0],setInputValue=_useState8[1];// modal\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isOpen=_useState10[0],setIsOpen=_useState10[1];var showModal=function showModal(){setIsOpen(true);};var hideModal=function hideModal(){setIsOpen(false);};// modal\nvar _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),qtd=_useState12[0],setQtd=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),amount=_useState14[0],setAmount=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),items=_useState16[0],setItems=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),itemsUnavailable=_useState18[0],setItemsUnavailable=_useState18[1];var decrement=function decrement(idProduto,item,quantity){if(quantity>1){update(idProduto,item,quantity-1);}};var increment=function increment(idProduto,item,quantity){update(idProduto,item,quantity+1);};var handleChange=function handleChange(e){setInputValue(_defineProperty({},e.target.name,e.target.value));};var handleBlur=function handleBlur(idProduto,item,e){e.preventDefault();var quantity=inputValue[e.target.name];if(parseInt(quantity)>0){update(idProduto,item,quantity);}};var update=function update(idProduto,item,quantity){setLoading(true);setAmount(0);setQtd(0);updateCart(idProduto,item,quantity).then(function(resultUpdate){if(resultUpdate.data.Codigo===500){if(resultUpdate.data.CodigoInterno===4){disconnect();return;}else{alert(resultUpdate.data.Status);}}localFetchItem();});/* Deixado somente 1 disconnect */ // .catch(reject => {\n//     disconnect();\n// })\n};// Scroll\nuseEffect(function(){return scrollToTop();},[isLoading]);var removeItem=function removeItem(idProduto,item){setLoading(true);setAmount(0);setQtd(0);removeFromCart(idProduto,item).then(function(result){localFetchItem();});/* Deixado somente 1 disconnect */ // .catch(reject => {\n//     disconnect();\n// })\n};// Load Data\nuseEffect(function(){scrollToTop();setLoading(true);fetchCartItems().then(function(result){setItems(result.data.Data.Dados);setQtd(result.data.Data.QuantidadeRegistrosTotal);//\nvar total=result.data.Data.Dados.reduce(function(acc,curr){return acc+curr.ValorTotalFinal;},0);setAmount(total);//\nvar unavailable=result.data.Data.Dados.filter(function(newarr){return newarr.Estoque===0;});if(unavailable.length<0){showModal();}setItemsUnavailable(unavailable);setLoading(false);//\nvar inputArray=[];result.data.Data.Dados.map(function(item){return inputArray.push(item.Quantidade);});setInputValue(inputArray);}).catch(function(reject){disconnect();});fetchProductsBySuggestion(5).then(function(result){if(result.data.Data){setProdutosSuggestion(result.data.Data.Dados);}}).then(function(result){return setLoadingSuggestion(false);});/* Deixado somente 1 disconnect */ // .catch(reject => {\n//     disconnect();\n// })\n},[cartItems]);var localFetchItem=function localFetchItem(){fetchCartItems().then(function(result){setItemSession('_carrinho',JSON.stringify(result.data.Data));refreshCartFn(result.data.Data);}).then(function(result){return setLoading(false);}).catch(function(reject){disconnect();});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"section\",{className:\"meu-carrinho container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sect-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sect-titulo\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"titulo h2\"},\"Meu carrinho\"),/*#__PURE__*/React.createElement(\"h6\",{className:\"titulo h6\"},\"(\",qtd,\" Itens)\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"tabela-items--wrapper\"},!isLoading?items.length>0?/*#__PURE__*/React.createElement(\"table\",{className:\"tabela tabela-items\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Imagem\"),/*#__PURE__*/React.createElement(\"th\",null,\"Nome do produto\"),/*#__PURE__*/React.createElement(\"th\",null,\"Quantidade\"),/*#__PURE__*/React.createElement(\"th\",null,\"Valor Unit\\xE1rio\"),/*#__PURE__*/React.createElement(\"th\",null,\"Valor Total\"),/*#__PURE__*/React.createElement(\"th\",null,\"A\\xE7\\xF5es\"))),/*#__PURE__*/React.createElement(\"tbody\",null,items.map(function(item,index){return/*#__PURE__*/React.createElement(\"tr\",{key:\"cart-item-\".concat(index),className:\"\".concat(item.Estoque<1&&'indisponivel')},/*#__PURE__*/React.createElement(\"td\",{className:\"card-item--header\"},/*#__PURE__*/React.createElement(\"img\",{src:item.LinkImagemLista,alt:\"\",className:\"img-card-produto\"})),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"p\",null,item.Descricao),/*#__PURE__*/React.createElement(\"p\",null,\"EAN: \",item.EAN),/*#__PURE__*/React.createElement(\"p\",{className:\"tabela-items--estoque\"},item.Estoque<1?'produto indisponível':\"\".concat(item.Estoque,\" dispon\\xEDveis\"))),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"form\",{className:\"form-adicionar\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",disabled:\"\".concat(item.Estoque<1?'disabled':''),name:\"btn-item\",className:\"btn form-adicionar--btn\",onClick:function onClick(){return decrement(item.idProduto,item.Item,item.Quantidade);}},\"-\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",disabled:\"\".concat(item.Estoque<1?'disabled':''),name:\"quantity-\".concat(item.Item)// usado o inputValue e nao o item.Quantidade para poder pegar valor do useState\n,value:inputValue[index],className:\"card-item--counter\",maxLength:4,onChange:handleChange,onBlur:function onBlur(e){return handleBlur(item.idProduto,item.Item,e);}// enter: e.which == 13\n,onKeyPress:function onKeyPress(e){return e.which==13?handleBlur(item.idProduto,item.Item,e):'';}}),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",disabled:\"\".concat(item.Estoque<1?'disabled':''),name:\"btn-item\",className:\"btn form-adicionar--btn\",onClick:function onClick(){return increment(item.idProduto,item.Item,item.Quantidade);}},\"+\"))),/*#__PURE__*/React.createElement(\"td\",null,\"R$ \",formatMoney(item.ValorFinal,2,',','.')),/*#__PURE__*/React.createElement(\"td\",null,\"R$ \",formatMoney(item.ValorTotalFinal,2,',','.')),/*#__PURE__*/React.createElement(\"td\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:function onClick(){if(window.confirm('Deseja excluir esse item?'))removeItem(item.idProduto,item.Item);},className:\"btn btn--icon tabela-items--delete\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon icon-trash\"}))));}))):/*#__PURE__*/React.createElement(\"span\",null,\"Carrinho vazio!\"):/*#__PURE__*/React.createElement(Loader,{short:\"false\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"sect-footer\"},items.length>0&&/*#__PURE__*/React.createElement(\"h3\",{className:\"titulo h3\"},\"Valor Total \",/*#__PURE__*/React.createElement(\"span\",{className:\"c-laranja arial-bold\"},\" R$ \",formatMoney(amount,2,',','.'),\" \")),/*#__PURE__*/React.createElement(\"div\",{className:\"sect-btn\"},items.length>0&&createElement('a',{href:\"/checkout\",className:\"btn btn--laranja btn--block btn--full btn--bold\"},\"Ir para o fechamento\"),createElement('a',{href:\"/\",className:\"btn btn-link btn--bold\"},\"Continuar Comprando\"))),/*#__PURE__*/React.createElement(\"h4\",{className:\"titulo h4 mais-produtos-titulo\"},\"Produtos para incrementar seu pedido\"),/*#__PURE__*/React.createElement(\"div\",{className:\"conteudo_interno\"},/*#__PURE__*/React.createElement(\"div\",{className:\"cards-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"overflow-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"cards cards-produto cards-produto-width-5 mais-produtos-cards\"},!isLoadingSuggestion?productsSuggestion.map(function(product){return/*#__PURE__*/React.createElement(ProductCard,{key:\"cart-card-\".concat(product.idProduto),product:product,origin:arrOrigin['pagina_carrinho_incrementar']});}):/*#__PURE__*/React.createElement(Loader,{short:\"false\"})))))),/*#__PURE__*/React.createElement(Modal,{show:isOpen,className:\"modal modal-boleto fade\"},/*#__PURE__*/React.createElement(Modal.Header,null,/*#__PURE__*/React.createElement(\"div\",{className:\"modal-header_container\"},/*#__PURE__*/React.createElement(\"img\",{src:\"./img/img-modal-indisponivel.png\",alt:\"Imagem representativa de ma folha de papel\"}),/*#__PURE__*/React.createElement(\"h2\",{className:\"titulo h2\"},\"Produto Indispon\\xEDvel\"),/*#__PURE__*/React.createElement(\"p\",null,\"Desculpe, o(s) produto(s) acabaram nos nossos estoques.\")),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",onClick:hideModal},/*#__PURE__*/React.createElement(\"i\",{className:\"icon icon-times\"}))),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"ol\",{className:\"lista-modal\"},itemsUnavailable.map(function(product){return/*#__PURE__*/React.createElement(\"li\",{key:\"unavailable-\".concat(product.idProduto),className:\"lista-modal_item\"},product.Descricao);})))),/*#__PURE__*/React.createElement(Footer,null));};var mapStateToProps=function mapStateToProps(state){return{cartItems:state.cart.items};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{refreshCartFn:function refreshCartFn(data){return dispatch(CartActions.refreshCart(data));}};};export default connect(mapStateToProps,mapDispatchToProps)(Cart);","map":{"version":3,"sources":["C:/Users/victor.abrao/Desktop/source/clientes-blue-cycle-ecommerce/src/pages/Cart.js"],"names":["React","useState","useEffect","createElement","Header","Footer","Modal","Loader","formatMoney","disconnect","scrollToTop","fetchCartItems","removeFromCart","updateCart","fetchProductsBySuggestion","ProductCard","arrOrigin","CartActions","connect","setItemSession","Swal","require","Cart","cartItems","refreshCartFn","productsSuggestion","setProdutosSuggestion","isLoadingSuggestion","setLoadingSuggestion","isLoading","setLoading","inputValue","setInputValue","isOpen","setIsOpen","showModal","hideModal","qtd","setQtd","amount","setAmount","items","setItems","itemsUnavailable","setItemsUnavailable","decrement","idProduto","item","quantity","update","increment","handleChange","e","target","name","value","handleBlur","preventDefault","parseInt","then","resultUpdate","data","Codigo","CodigoInterno","alert","Status","localFetchItem","removeItem","result","Data","Dados","QuantidadeRegistrosTotal","total","reduce","acc","curr","ValorTotalFinal","unavailable","filter","newarr","Estoque","length","inputArray","map","push","Quantidade","catch","reject","JSON","stringify","index","LinkImagemLista","Descricao","EAN","Item","which","ValorFinal","window","confirm","href","className","product","mapStateToProps","state","cart","mapDispatchToProps","dispatch","refreshCart"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createElement } from 'react';\r\n// default\r\nimport Header from '../components/Header';\r\nimport Footer from '../components/Footer';\r\n\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport { Loader } from '../components/Loader/Loader';\r\nimport { formatMoney, disconnect, scrollToTop } from '../utils';\r\nimport { fetchCartItems, removeFromCart, updateCart } from '../services/cart-api';\r\nimport { fetchProductsBySuggestion } from '../services/products-api';\r\nimport ProductCard from '../components/Product/ProductCard';\r\nimport { arrOrigin } from '../constants';\r\nimport * as CartActions from '../store/actions/cart'\r\nimport { connect } from 'react-redux';\r\nimport { setItemSession } from '../utils';\r\n\r\nconst Swal = require('sweetalert2');\r\n\r\n\r\nconst Cart = ({ cartItems, refreshCartFn }) => {\r\n    const [productsSuggestion, setProdutosSuggestion] = useState([]);\r\n    const [isLoadingSuggestion, setLoadingSuggestion] = useState(true);\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [inputValue, setInputValue] = useState({});\r\n\r\n    // modal\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    const showModal = () => {\r\n        setIsOpen(true);\r\n    };\r\n\r\n    const hideModal = () => {\r\n        setIsOpen(false);\r\n    };\r\n    // modal\r\n\r\n    const [qtd, setQtd] = useState(0);\r\n    const [amount, setAmount] = useState(0);\r\n    const [items, setItems] = useState([]);\r\n    const [itemsUnavailable, setItemsUnavailable] = useState([]);\r\n\r\n    const decrement = (idProduto, item, quantity) => {\r\n        if (quantity > 1) {\r\n            update(idProduto, item, quantity - 1);\r\n        }\r\n    }\r\n\r\n    const increment = (idProduto, item, quantity) => {\r\n        update(idProduto, item, quantity + 1);\r\n    }\r\n\r\n    const handleChange = (e) => {\r\n        setInputValue({ [e.target.name]: e.target.value });\r\n    }\r\n\r\n    const handleBlur = (idProduto, item, e) => {\r\n        e.preventDefault();\r\n\r\n        let quantity = inputValue[e.target.name];\r\n\r\n        if (parseInt(quantity) > 0) {\r\n            update(idProduto, item, quantity);\r\n        }\r\n    }\r\n\r\n    const update = (idProduto, item, quantity) => {\r\n        setLoading(true);\r\n        setAmount(0);\r\n        setQtd(0);\r\n\r\n        updateCart(idProduto, item, quantity)\r\n            .then(resultUpdate => {\r\n                if (resultUpdate.data.Codigo === 500) {\r\n                    if (resultUpdate.data.CodigoInterno === 4) {\r\n                        disconnect()\r\n                        return\r\n                    } else {\r\n                        alert(resultUpdate.data.Status);\r\n                    }\r\n                }\r\n\r\n                localFetchItem()\r\n            })\r\n        /* Deixado somente 1 disconnect */\r\n        // .catch(reject => {\r\n        //     disconnect();\r\n        // })\r\n    }\r\n\r\n    // Scroll\r\n    useEffect(() => scrollToTop(), [isLoading]);\r\n\r\n    const removeItem = (idProduto, item) => {\r\n        setLoading(true);\r\n        setAmount(0);\r\n        setQtd(0);\r\n\r\n        removeFromCart(idProduto, item)\r\n            .then(result => {\r\n                localFetchItem()\r\n            })\r\n        /* Deixado somente 1 disconnect */\r\n        // .catch(reject => {\r\n        //     disconnect();\r\n        // })\r\n    }\r\n\r\n    // Load Data\r\n    useEffect(() => {\r\n        scrollToTop();\r\n\r\n        setLoading(true);\r\n\r\n        fetchCartItems()\r\n            .then(result => {\r\n                setItems(result.data.Data.Dados)\r\n                setQtd(result.data.Data.QuantidadeRegistrosTotal)\r\n\r\n                //\r\n                const total = result.data.Data.Dados.reduce((acc, curr) => acc + curr.ValorTotalFinal, 0);\r\n                setAmount(total)\r\n\r\n                //\r\n                const unavailable = result.data.Data.Dados.filter(newarr => newarr.Estoque === 0);\r\n                if (unavailable.length < 0) {\r\n                    showModal()\r\n                }\r\n                setItemsUnavailable(unavailable);\r\n\r\n                setLoading(false);\r\n\r\n                //\r\n                let inputArray = [];\r\n                result.data.Data.Dados.map(item => inputArray.push(item.Quantidade));\r\n                setInputValue(inputArray);\r\n            })\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n\r\n        fetchProductsBySuggestion(5)\r\n            .then(result => {\r\n                if (result.data.Data) {\r\n                    setProdutosSuggestion(result.data.Data.Dados)\r\n                }\r\n            })\r\n            .then(result => setLoadingSuggestion(false))\r\n        /* Deixado somente 1 disconnect */\r\n        // .catch(reject => {\r\n        //     disconnect();\r\n        // })\r\n\r\n    }, [cartItems]);\r\n\r\n    const localFetchItem = () => {\r\n        fetchCartItems()\r\n            .then(result => {\r\n                setItemSession('_carrinho', JSON.stringify(result.data.Data))\r\n                refreshCartFn(result.data.Data)\r\n            })\r\n            .then(result => setLoading(false))\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Header />\r\n            <section className=\"meu-carrinho container\">\r\n                <div className=\"sect-header\">\r\n                    <div className=\"sect-titulo\">\r\n                        <h2 className=\"titulo h2\">Meu carrinho</h2>\r\n                        <h6 className=\"titulo h6\">({qtd} Itens)</h6>\r\n                    </div>\r\n                </div>\r\n                <div className=\"tabela-items--wrapper\">\r\n                    {!isLoading ? (\r\n                        items.length > 0 ? (\r\n                            <table className=\"tabela tabela-items\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th>Imagem</th>\r\n                                        <th>Nome do produto</th>\r\n                                        <th>Quantidade</th>\r\n                                        <th>Valor Unitário</th>\r\n                                        <th>Valor Total</th>\r\n                                        <th>Ações</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {items.map((item, index) => (\r\n                                        <tr key={`cart-item-${index}`} className={`${item.Estoque < 1 && 'indisponivel'}`}>\r\n                                            <td className=\"card-item--header\">\r\n                                                <img src={item.LinkImagemLista} alt=\"\" className=\"img-card-produto\" />\r\n                                            </td>\r\n                                            <td>\r\n                                                <p>{item.Descricao}</p>\r\n                                                <p>EAN: {item.EAN}</p>\r\n                                                <p className=\"tabela-items--estoque\">\r\n                                                    {item.Estoque < 1\r\n                                                        ? 'produto indisponível'\r\n                                                        : `${item.Estoque} disponíveis`\r\n                                                    }\r\n                                                </p>\r\n                                            </td>\r\n                                            <td>\r\n                                                <form className=\"form-adicionar\">\r\n                                                    <button\r\n                                                        type=\"button\"\r\n                                                        disabled={`${item.Estoque < 1 ? 'disabled' : ''}`}\r\n                                                        name=\"btn-item\"\r\n                                                        className=\"btn form-adicionar--btn\"\r\n                                                        onClick={() => decrement(item.idProduto, item.Item, item.Quantidade)}>-</button>\r\n                                                    <input\r\n                                                        type=\"number\"\r\n                                                        disabled={`${item.Estoque < 1 ? 'disabled' : ''}`}\r\n                                                        name={`quantity-${item.Item}`}\r\n                                                        // usado o inputValue e nao o item.Quantidade para poder pegar valor do useState\r\n                                                        value={inputValue[index]}\r\n                                                        className=\"card-item--counter\"\r\n                                                        maxLength={4}\r\n                                                        onChange={handleChange}\r\n                                                        onBlur={(e) => handleBlur(item.idProduto, item.Item, e)}\r\n                                                        // enter: e.which == 13\r\n                                                        onKeyPress={(e) => e.which == 13 ? handleBlur(item.idProduto, item.Item, e) : ''}\r\n                                                    />\r\n                                                    <button\r\n                                                        type=\"button\"\r\n                                                        disabled={`${item.Estoque < 1 ? 'disabled' : ''}`}\r\n                                                        name=\"btn-item\"\r\n                                                        className=\"btn form-adicionar--btn\"\r\n                                                        onClick={() => increment(item.idProduto, item.Item, item.Quantidade)}>+</button>\r\n                                                </form>\r\n                                            </td>\r\n                                            <td>R$ {formatMoney(item.ValorFinal, 2, ',', '.')}</td>\r\n                                            <td>R$ {formatMoney(item.ValorTotalFinal, 2, ',', '.')}</td>\r\n                                            <td className=\"text-center\">\r\n                                                <button type=\"button\" onClick={() => { if (window.confirm('Deseja excluir esse item?')) removeItem(item.idProduto, item.Item) }} className=\"btn btn--icon tabela-items--delete\"><span className=\"icon icon-trash\"></span></button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        ) : (\r\n                                <span>Carrinho vazio!</span>\r\n                            )\r\n                    ) : (\r\n                            <Loader short=\"false\" />\r\n                        )}\r\n                </div>\r\n                <div className=\"sect-footer\">\r\n                    {items.length > 0 &&\r\n                        <h3 className=\"titulo h3\">Valor Total <span className=\"c-laranja arial-bold\"> R$ {formatMoney(amount, 2, ',', '.')} </span></h3>\r\n                    }\r\n                    <div className=\"sect-btn\">\r\n                        {items.length > 0 &&\r\n                            createElement('a', { href: \"/checkout\", className: \"btn btn--laranja btn--block btn--full btn--bold\" }, \"Ir para o fechamento\")\r\n                        }\r\n                        {createElement('a', { href: \"/\", className: \"btn btn-link btn--bold\" }, \"Continuar Comprando\")}\r\n                        {/* <a href=\"/\" className=\"btn btn-link btn--bold\">Continuar Comprando</a> */}\r\n                    </div>\r\n                </div>\r\n\r\n                <h4 className=\"titulo h4 mais-produtos-titulo\">Produtos para incrementar seu pedido</h4>\r\n                <div className=\"conteudo_interno\">\r\n                    <div className=\"cards-container\">\r\n                        <div className=\"overflow-auto\">\r\n                            <div className=\"cards cards-produto cards-produto-width-5 mais-produtos-cards\">\r\n                                {!isLoadingSuggestion ? (\r\n                                    productsSuggestion.map(product =>\r\n                                        <ProductCard\r\n                                            key={`cart-card-${product.idProduto}`}\r\n                                            product={product}\r\n                                            origin={arrOrigin['pagina_carrinho_incrementar']}\r\n                                        />\r\n                                    )\r\n                                ) : (\r\n                                        <Loader short=\"false\" />\r\n                                    )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* <!-- Modal --> */}\r\n            <Modal show={isOpen} className=\"modal modal-boleto fade\">\r\n                <Modal.Header>\r\n                    <div className=\"modal-header_container\">\r\n                        <img src=\"./img/img-modal-indisponivel.png\" alt=\"Imagem representativa de ma folha de papel\" />\r\n                        <h2 className=\"titulo h2\">Produto Indisponível</h2>\r\n                        <p>Desculpe, o(s) produto(s) acabaram nos nossos estoques.</p>\r\n                    </div>\r\n                    <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={hideModal}>\r\n                        <i className=\"icon icon-times\"></i>\r\n                    </button>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <ol className=\"lista-modal\">\r\n                        {itemsUnavailable.map(product => (\r\n                            <li key={`unavailable-${product.idProduto}`} className=\"lista-modal_item\">{product.Descricao}</li>\r\n                        ))}\r\n                    </ol>\r\n                </Modal.Body>\r\n            </Modal>\r\n\r\n            <Footer />\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    cartItems: state.cart.items\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    refreshCartFn: (data) => dispatch(CartActions.refreshCart(data))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Cart);"]},"metadata":{},"sourceType":"module"}