{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\victor.abrao\\\\Desktop\\\\source\\\\clientes-blue-cycle-ecommerce\\\\src\\\\pages\\\\Search.js\";\nimport React, { useState, useEffect } from 'react';\nimport Pagination from 'react-js-pagination'; // default\n\nimport Header from '../components/Header';\nimport Footer from '../components/Footer';\nimport Manufacturer from '../components/SideBar/Manufacturer';\nimport Category from '../components/SideBar/Category';\nimport ProductCard from '../components/Product/ProductCard';\nimport { Loader } from '../components/Loader/Loader';\nimport { scrollToTop, disconnect, arrayStringToArrayInt, clearSubCategorias } from '../utils';\nimport { fetchProductsSearch } from '../services/products-api';\nimport { arrOrigin } from '../constants';\nimport { getCategoryById, getAllCategories } from '../containers/CategoriesContainer';\nimport { getManufacturerById } from '../containers/ManufacturersContainer';\n\nconst Search = () => {\n  const [isLoading, setLoading] = useState(true);\n  const [qtd, setQtd] = useState(0);\n  const [products, setProducts] = useState([]);\n  const [category, setCategory] = useState([]);\n  const [subCategory, setSubCategory] = useState([]);\n  const [manufacturer, setManufacturer] = useState([]);\n  let search = window.location.search;\n  let params = new URLSearchParams(search);\n  const term = params.get('t') || '';\n  const fornecedores = params.get('f') || '';\n  let arrFornecedores = fornecedores ? arrayStringToArrayInt(fornecedores) : [];\n  const categorias = params.get('c') || '';\n  let arrCategorias = categorias ? arrayStringToArrayInt(categorias) : [];\n  const subCategorias = params.get('s') || '';\n  let arrSubCategorias = subCategorias ? arrayStringToArrayInt(subCategorias) : [];\n\n  const filterHierarquia = idList => {\n    let posArrHierarquia;\n    let arr = idList;\n\n    for (let a in arr) {\n      posArrHierarquia = getCategoryById(arr[a]);\n      arr[a] = posArrHierarquia.Hierarquia;\n    }\n\n    return arr;\n  };\n\n  let arrHierarquia = null;\n  let arrClearSubCategorias = null;\n  let xArrClearSubCategorias = null;\n\n  if (subCategorias) {\n    xArrClearSubCategorias = clearSubCategorias(arrSubCategorias, arrCategorias, getAllCategories(0));\n    arrClearSubCategorias = clearSubCategorias(arrSubCategorias, arrCategorias, getAllCategories(0));\n    arrHierarquia = filterHierarquia(arrClearSubCategorias);\n  }\n\n  if (categorias && (arrHierarquia === null || arrHierarquia.length === 0)) {\n    arrHierarquia = filterHierarquia(arrayStringToArrayInt(categorias));\n  } // Paginate\n\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const totalRecords = qtd;\n  const recordPerPage = process.env.REACT_APP_PAGINATION_RECORD_PER_PAGE;\n  const pageRange = process.env.REACT_APP_PAGINATION_PAGE_RANGE;\n\n  const handlePageChange = pageNumber => {\n    if (currentPage !== pageNumber) {\n      setLoading(true);\n      setCurrentPage(pageNumber);\n    }\n  }; // Scroll\n\n\n  useEffect(() => scrollToTop(), [isLoading]); // Load Data\n\n  useEffect(() => {\n    if (term === '' && fornecedores === '' && categorias === '') {\n      window.location.href = '/';\n      return null;\n    }\n\n    if (arrFornecedores.length === 1) {\n      const listManufacturer = getManufacturerById(arrFornecedores);\n      setManufacturer(listManufacturer);\n    }\n\n    if (arrCategorias.length === 1) {\n      setCategory(listCategory => getCategoryById(arrCategorias));\n    }\n\n    if (xArrClearSubCategorias && xArrClearSubCategorias.length === 1 && arrCategorias.length > 0) {\n      setSubCategory(listCategory => getCategoryById(xArrClearSubCategorias));\n    }\n\n    fetchProductsSearch(term === '' ? null : term, fornecedores === '' ? null : fornecedores, categorias === '' ? null : arrHierarquia, currentPage, recordPerPage).then(result => {\n      setProducts(result.data.Data.Dados);\n      setQtd(result.data.Data.QuantidadeRegistrosTotal);\n    }).then(result => setLoading(false)).catch(reject => {\n      disconnect();\n    });\n  }, [currentPage]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"conteudo_interno conteudo_padrao container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"filtro-sticky d-none d-lg-block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Manufacturer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Category, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cards-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"titulo-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"titulo h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 25\n    }\n  }, arrFornecedores.length > 1 && /*#__PURE__*/React.createElement(\"small\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 60\n    }\n  }, \"Fornecedor(es)\"), ' ', manufacturer && manufacturer.Nome, ' ', arrCategorias.length > 1 && /*#__PURE__*/React.createElement(\"small\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 58\n    }\n  }, \"Categoria(s)\"), ' ', category && category.Descricao, ' ', arrSubCategorias.length > 1 && /*#__PURE__*/React.createElement(\"small\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 61\n    }\n  }, \"Subcategoria(s)\"), ' ', subCategory && subCategory.Descricao, ' ', term && `Busca ${term}`), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"total-itens\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 25\n    }\n  }, \"Total de Itens: \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"total-itens_numero\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 68\n    }\n  }, qtd))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cards cards-produto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 21\n    }\n  }, !isLoading ? products.length > 0 ? products.map(product => /*#__PURE__*/React.createElement(ProductCard, {\n    key: `search-card-${product.idProduto}`,\n    product: product,\n    origin: arrOrigin['pagina_busca'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 37\n    }\n  })) : 'Nenhum produto encontrado' : /*#__PURE__*/React.createElement(Loader, {\n    short: \"false\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(\"nav\", {\n    \"aria-label\": \"paginacao-promocoes\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, !isLoading && /*#__PURE__*/React.createElement(Pagination, {\n    hideFirstLastPages: true,\n    activePage: currentPage,\n    itemsCountPerPage: parseInt(recordPerPage),\n    totalItemsCount: totalRecords,\n    pageRangeDisplayed: parseInt(pageRange),\n    onChange: handlePageChange,\n    innerClass: \"pagination justify-content-end\",\n    itemClass: \"page-item\",\n    linkClass: \"page-link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 29\n    }\n  })))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default Search;","map":{"version":3,"sources":["C:/Users/victor.abrao/Desktop/source/clientes-blue-cycle-ecommerce/src/pages/Search.js"],"names":["React","useState","useEffect","Pagination","Header","Footer","Manufacturer","Category","ProductCard","Loader","scrollToTop","disconnect","arrayStringToArrayInt","clearSubCategorias","fetchProductsSearch","arrOrigin","getCategoryById","getAllCategories","getManufacturerById","Search","isLoading","setLoading","qtd","setQtd","products","setProducts","category","setCategory","subCategory","setSubCategory","manufacturer","setManufacturer","search","window","location","params","URLSearchParams","term","get","fornecedores","arrFornecedores","categorias","arrCategorias","subCategorias","arrSubCategorias","filterHierarquia","idList","posArrHierarquia","arr","a","Hierarquia","arrHierarquia","arrClearSubCategorias","xArrClearSubCategorias","length","currentPage","setCurrentPage","totalRecords","recordPerPage","process","env","REACT_APP_PAGINATION_RECORD_PER_PAGE","pageRange","REACT_APP_PAGINATION_PAGE_RANGE","handlePageChange","pageNumber","href","listManufacturer","listCategory","then","result","data","Data","Dados","QuantidadeRegistrosTotal","catch","reject","Nome","Descricao","map","product","idProduto","parseInt"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Pagination from 'react-js-pagination';\r\n// default\r\nimport Header from '../components/Header';\r\nimport Footer from '../components/Footer';\r\n\r\nimport Manufacturer from '../components/SideBar/Manufacturer';\r\nimport Category from '../components/SideBar/Category';\r\n\r\nimport ProductCard from '../components/Product/ProductCard';\r\nimport { Loader } from '../components/Loader/Loader';\r\nimport { scrollToTop, disconnect, arrayStringToArrayInt, clearSubCategorias } from '../utils';\r\nimport { fetchProductsSearch } from '../services/products-api';\r\nimport { arrOrigin } from '../constants';\r\nimport { getCategoryById, getAllCategories } from '../containers/CategoriesContainer';\r\nimport { getManufacturerById } from '../containers/ManufacturersContainer';\r\n\r\nconst Search = () => {\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [qtd, setQtd] = useState(0);\r\n    const [products, setProducts] = useState([]);\r\n\r\n    const [category, setCategory] = useState([]);\r\n    const [subCategory, setSubCategory] = useState([]);\r\n    const [manufacturer, setManufacturer] = useState([]);\r\n\r\n    let search = window.location.search;\r\n    let params = new URLSearchParams(search);\r\n\r\n    const term = params.get('t') || '';\r\n    const fornecedores = params.get('f') || '';\r\n    let arrFornecedores = fornecedores ? arrayStringToArrayInt(fornecedores) : [];\r\n    const categorias = params.get('c') || '';\r\n    let arrCategorias = categorias ? arrayStringToArrayInt(categorias) : [];\r\n    const subCategorias = params.get('s') || '';\r\n    let arrSubCategorias = subCategorias ? arrayStringToArrayInt(subCategorias) : [];\r\n\r\n    const filterHierarquia = (idList) => {\r\n        let posArrHierarquia;\r\n        \r\n        let arr = idList;\r\n\r\n        for (let a in arr) {\r\n            posArrHierarquia = getCategoryById(arr[a]);\r\n            arr[a] = posArrHierarquia.Hierarquia\r\n        }\r\n\r\n        return arr;\r\n    }\r\n\r\n    let arrHierarquia = null;\r\n    let arrClearSubCategorias = null;\r\n    let xArrClearSubCategorias = null;\r\n\r\n    if (subCategorias) {\r\n        xArrClearSubCategorias = clearSubCategorias(arrSubCategorias, arrCategorias, getAllCategories(0));\r\n\r\n        arrClearSubCategorias = clearSubCategorias(arrSubCategorias, arrCategorias, getAllCategories(0));\r\n        arrHierarquia = filterHierarquia(arrClearSubCategorias);\r\n    }\r\n\r\n    if (categorias && (arrHierarquia === null || arrHierarquia.length === 0)) {\r\n        arrHierarquia = filterHierarquia(arrayStringToArrayInt(categorias))\r\n    }\r\n\r\n\r\n    // Paginate\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const totalRecords = qtd;\r\n    const recordPerPage = process.env.REACT_APP_PAGINATION_RECORD_PER_PAGE;\r\n    const pageRange = process.env.REACT_APP_PAGINATION_PAGE_RANGE;\r\n\r\n    const handlePageChange = pageNumber => {\r\n        if (currentPage !== pageNumber) {\r\n            setLoading(true)\r\n            setCurrentPage(pageNumber);\r\n        }\r\n    }\r\n\r\n    // Scroll\r\n    useEffect(() => scrollToTop(), [isLoading]);\r\n\r\n    // Load Data\r\n    useEffect(() => {\r\n        if (term === '' && fornecedores === '' && categorias === '') {\r\n            window.location.href = '/';\r\n            return null;\r\n        }\r\n\r\n        if (arrFornecedores.length === 1) {\r\n            const listManufacturer = getManufacturerById(arrFornecedores);\r\n            setManufacturer(listManufacturer);\r\n        }\r\n\r\n        if (arrCategorias.length === 1) {\r\n            setCategory(listCategory => getCategoryById(arrCategorias));\r\n        }\r\n\r\n        if (xArrClearSubCategorias && xArrClearSubCategorias.length === 1 && arrCategorias.length > 0) {\r\n            setSubCategory(listCategory => getCategoryById(xArrClearSubCategorias));\r\n        }\r\n\r\n        fetchProductsSearch(term === '' ? null : term, fornecedores === '' ? null : fornecedores, categorias === '' ? null : arrHierarquia, currentPage, recordPerPage)\r\n            .then(result => {\r\n                setProducts(result.data.Data.Dados)\r\n                setQtd(result.data.Data.QuantidadeRegistrosTotal)\r\n            })\r\n            .then(result => setLoading(false))\r\n            .catch(reject => {\r\n                disconnect();\r\n            })\r\n    }, [currentPage])\r\n\r\n    return (\r\n        <>\r\n            <Header />\r\n            <section className=\"conteudo_interno conteudo_padrao container\">\r\n                <div className=\"filtro-sticky d-none d-lg-block\">\r\n                    <Manufacturer />\r\n                    <Category />\r\n                </div>\r\n                <div className=\"cards-container\">\r\n                    <div className=\"titulo-container\">\r\n                        <h4 className=\"titulo h2\">\r\n                            {arrFornecedores.length > 1 && <small className=\"text-muted\">Fornecedor(es)</small>}{' '}\r\n                            {manufacturer && manufacturer.Nome}{' '}\r\n                            {arrCategorias.length > 1 && <small className=\"text-muted\">Categoria(s)</small>}{' '}\r\n                            {category && category.Descricao}{' '}\r\n                            {arrSubCategorias.length > 1 && <small className=\"text-muted\">Subcategoria(s)</small>}{' '}\r\n                            {subCategory && subCategory.Descricao}{' '}\r\n                            {term && `Busca ${term}`}\r\n                        </h4>\r\n                        <p className=\"total-itens\">Total de Itens: <span className=\"total-itens_numero\">{qtd}</span></p>\r\n                    </div>\r\n                    <div className=\"cards cards-produto\">\r\n                        {!isLoading ? (\r\n                            products.length > 0\r\n                                ? products.map(product =>\r\n                                    <ProductCard\r\n                                        key={`search-card-${product.idProduto}`}\r\n                                        product={product}\r\n                                        origin={arrOrigin['pagina_busca']}\r\n                                    />\r\n                                )\r\n                                : 'Nenhum produto encontrado'\r\n                        ) : (\r\n                                <Loader short=\"false\" />\r\n                            )}\r\n                    </div>\r\n                    <nav aria-label=\"paginacao-promocoes\">\r\n                        {!isLoading &&\r\n                            <Pagination\r\n                                hideFirstLastPages\r\n                                activePage={currentPage}\r\n                                itemsCountPerPage={parseInt(recordPerPage)}\r\n                                totalItemsCount={totalRecords}\r\n                                pageRangeDisplayed={parseInt(pageRange)}\r\n                                onChange={handlePageChange}\r\n                                innerClass=\"pagination justify-content-end\"\r\n                                itemClass=\"page-item\"\r\n                                linkClass=\"page-link\"\r\n                            />\r\n                        }\r\n                    </nav>\r\n                </div>\r\n            </section>\r\n            <Footer />\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Search;"]},"metadata":{},"sourceType":"module"}