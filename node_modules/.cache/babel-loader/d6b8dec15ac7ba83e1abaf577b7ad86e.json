{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\victor.abrao\\\\Desktop\\\\source\\\\clientes-blue-cycle-ecommerce\\\\src\\\\pages\\\\Login.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport { fetchLogin, postDevice, fetchSession } from '../services/login-api';\nimport { fetchManufacturers } from '../services/manufacturers-api';\nimport { fetchCategories } from '../services/categories-api';\nimport { fetchVersion, fetchHomolog } from '../services/system-api';\nimport { fetchCartItems } from '../services/cart-api';\nimport { setItemSession, getItemSession } from '../utils';\nimport { deviceType, browserName, browserVersion, osName, osVersion } from \"react-device-detect\";\nimport { v4 as uuidv4 } from 'uuid';\nimport Cookies from 'js-cookie';\nimport { fetchProductsByTagHome } from '../services/products-api';\n\nconst Login = props => {\n  const [state, setState] = useState({\n    usuario: \"\",\n    senha: \"\"\n  });\n  const [loading, setLoading] = useState(false);\n  const latestProps = useRef(props);\n  useEffect(() => {\n    // localStorage.clear();\n    latestProps.current = props;\n  }, []);\n\n  const handleChange = e => {\n    const {\n      id,\n      value\n    } = e.target;\n    setState(prevState => ({ ...prevState,\n      [id]: value\n    }));\n  };\n\n  const handleSubmitClick = e => {\n    e.preventDefault();\n    setLoading(true);\n    const usuario = state.usuario;\n    const senha = state.senha;\n\n    const doLogin = idDevice => {\n      fetchLogin(usuario, senha, idDevice).then(result => {\n        if (result.data.Codigo === 200) {\n          const resultData = result.data.Data.Retorno;\n          const client = {\n            idCliente: resultData.idCliente,\n            idUsuario: resultData.idUsuario,\n            Login: resultData.Login,\n            Nome: resultData.Nome,\n            Email: resultData.Email,\n            ukPedido: resultData.ukPedido,\n            DataEmissao: resultData.DataEmissao,\n            NumeroItens: resultData.NumeroItens,\n            PedidoAlterado: resultData.PedidoAlterado,\n            LinkExpiracaoSessao: resultData.LinkExpiracaoSessao\n          };\n          setItemSession('_dados', JSON.stringify(client));\n          setItemSession('_pedido', client.ukPedido);\n          setItemSession('_token', resultData.TokenResposta);\n          Promise.all([fetchManufacturers(resultData.TokenResposta), fetchCategories(resultData.TokenResposta), fetchVersion(resultData.TokenResposta), fetchHomolog(resultData.TokenResposta), fetchCartItems(resultData.TokenResposta)]).then(resultFetch => {\n            setItemSession('_fornecedores', JSON.stringify(resultFetch[0].data.Data.Dados));\n            setItemSession('_categorias', JSON.stringify(resultFetch[1].data.Data.Dados));\n            setItemSession('_versao', JSON.stringify(resultFetch[2].data.Data));\n            setItemSession('_homolog', JSON.stringify(resultFetch[3].data.Data));\n            setItemSession('_carrinho', JSON.stringify(resultFetch[4].data.Data));\n            window.location.href = process.env.REACT_APP_BASE_URL;\n          });\n        } else {\n          latestProps.current.history.push('/unauthorized');\n        }\n\n        ;\n      }).catch(error => {\n        latestProps.current.history.push('/unauthorized');\n      });\n    };\n\n    var ambiente = process.env.REACT_APP_API_EMPRESA;\n    var isHomolog = ambiente.toLowerCase().includes(\"Teste\") ? true : false;\n    var myCookie = Cookies.get('_register_' + isHomolog);\n    let device = myCookie;\n\n    if (!myCookie || device == null || device == '' || device == 0) {\n      const browser = browserName + ' ' + browserVersion + ' ' + deviceType;\n      const so = osName + ' ' + osVersion;\n      const serialNumber = uuidv4();\n      const uniqueKey = uuidv4();\n      postDevice(browser, so, uniqueKey, serialNumber).then(result => {\n        Cookies.remove('_register_' + isHomolog);\n        Cookies.set('_register_' + isHomolog, result.data.Data.Retorno, {\n          expires: 3650\n        });\n        return result.data.Data.Retorno;\n      }).then(result => doLogin(result));\n    } else {\n      doLogin(device);\n    }\n  }; // se est치 logado, direciona para Home\n\n\n  if (getItemSession('_token')) {\n    fetchSession().then(result => {\n      if (result.CodigoInterno != 4) {\n        window.location.href = process.env.REACT_APP_BASE_URL;\n      } else {\n        localStorage.clear();\n      }\n    });\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"section\", {\n    className: \"conteudo_interno container\",\n    id: \"painellogin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"center\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"http://iis3.blink.com.br:13162/Images/logo_login.png\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group text-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"exampleInputEmail1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 25\n    }\n  }, \"Usu\\xE1rio\"), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"input-group-prepend\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"iconlogin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    width: \"1em\",\n    height: \"1em\",\n    viewBox: \"0 0 16 16\",\n    class: \"bi bi-people\",\n    fill: \"currentColor\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    \"fill-rule\": \"evenodd\",\n    d: \"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.995-.944v-.002.002zM7.022 13h7.956a.274.274 0 0 0 .014-.002l.008-.002c-.002-.264-.167-1.03-.76-1.72C13.688 10.629 12.718 10 11 10c-1.717 0-2.687.63-3.24 1.276-.593.69-.759 1.457-.76 1.72a1.05 1.05 0 0 0 .022.004zm7.973.056v-.002.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10c-1.668.02-2.615.64-3.16 1.276C1.163 11.97 1 12.739 1 13h3c0-1.045.323-2.086.92-3zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    id: \"usuario\",\n    \"aria-describedby\": \"usuarioHelp\",\n    placeholder: \"CNPJ\",\n    value: state.usuario,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group text-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"exampleInputPassword1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 25\n    }\n  }, \"Senha\"), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"input-group-prepend\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"iconlogin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    width: \"1em\",\n    height: \"1em\",\n    viewBox: \"0 0 16 16\",\n    class: \"bi bi-key\",\n    fill: \"currentColor\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    \"fill-rule\": \"evenodd\",\n    d: \"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    className: \"form-control\",\n    id: \"senha\",\n    placeholder: \"C\\xF3digo\",\n    value: state.senha,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-check\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    id: \"acessarlogin\",\n    className: \"btn btn-primary\",\n    onClick: handleSubmitClick,\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 21\n    }\n  }, loading && /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-refresh fa-spin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 37\n    }\n  }), \"Acessar\"))));\n};\n\nexport default Login;","map":{"version":3,"sources":["C:/Users/victor.abrao/Desktop/source/clientes-blue-cycle-ecommerce/src/pages/Login.js"],"names":["React","useState","useEffect","useRef","fetchLogin","postDevice","fetchSession","fetchManufacturers","fetchCategories","fetchVersion","fetchHomolog","fetchCartItems","setItemSession","getItemSession","deviceType","browserName","browserVersion","osName","osVersion","v4","uuidv4","Cookies","fetchProductsByTagHome","Login","props","state","setState","usuario","senha","loading","setLoading","latestProps","current","handleChange","e","id","value","target","prevState","handleSubmitClick","preventDefault","doLogin","idDevice","then","result","data","Codigo","resultData","Data","Retorno","client","idCliente","idUsuario","Nome","Email","ukPedido","DataEmissao","NumeroItens","PedidoAlterado","LinkExpiracaoSessao","JSON","stringify","TokenResposta","Promise","all","resultFetch","Dados","window","location","href","process","env","REACT_APP_BASE_URL","history","push","catch","error","ambiente","REACT_APP_API_EMPRESA","isHomolog","toLowerCase","includes","myCookie","get","device","browser","so","serialNumber","uniqueKey","remove","set","expires","CodigoInterno","localStorage","clear"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { fetchLogin, postDevice, fetchSession } from '../services/login-api';\r\nimport { fetchManufacturers } from '../services/manufacturers-api';\r\nimport { fetchCategories } from '../services/categories-api';\r\nimport { fetchVersion, fetchHomolog } from '../services/system-api';\r\nimport { fetchCartItems } from '../services/cart-api';\r\nimport { setItemSession, getItemSession } from '../utils';\r\n\r\nimport {\r\n    deviceType,\r\n    browserName,\r\n    browserVersion,\r\n    osName,\r\n    osVersion\r\n} from \"react-device-detect\";\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport Cookies from 'js-cookie';\r\nimport { fetchProductsByTagHome } from '../services/products-api';\r\n\r\nconst Login = (props) => {\r\n    const [state, setState] = useState({\r\n        usuario: \"\",\r\n        senha: \"\"\r\n    })\r\n\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const latestProps = useRef(props);\r\n\r\n    useEffect(() => {\r\n        // localStorage.clear();\r\n\r\n        latestProps.current = props;\r\n    }, []);\r\n\r\n    const handleChange = (e) => {\r\n        const { id, value } = e.target\r\n        setState(prevState => ({\r\n            ...prevState,\r\n            [id]: value\r\n        }))\r\n    }\r\n\r\n    const handleSubmitClick = (e) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        const usuario = state.usuario;\r\n        const senha = state.senha;\r\n\r\n        const doLogin = (idDevice) => {\r\n            fetchLogin(usuario, senha, idDevice)\r\n                .then(result => {\r\n                    if (result.data.Codigo === 200) {\r\n                        const resultData = result.data.Data.Retorno;\r\n                        const client = {\r\n                            idCliente: resultData.idCliente,\r\n                            idUsuario: resultData.idUsuario,\r\n                            Login: resultData.Login,\r\n                            Nome: resultData.Nome,\r\n                            Email: resultData.Email,\r\n                            ukPedido: resultData.ukPedido,\r\n                            DataEmissao: resultData.DataEmissao,\r\n                            NumeroItens: resultData.NumeroItens,\r\n                            PedidoAlterado: resultData.PedidoAlterado,\r\n                            LinkExpiracaoSessao: resultData.LinkExpiracaoSessao\r\n                        }\r\n\r\n                        setItemSession('_dados', JSON.stringify(client));\r\n                        setItemSession('_pedido', client.ukPedido);\r\n                        setItemSession('_token', resultData.TokenResposta);\r\n\r\n                        Promise.all([\r\n                            fetchManufacturers(resultData.TokenResposta),\r\n                            fetchCategories(resultData.TokenResposta),\r\n                            fetchVersion(resultData.TokenResposta),\r\n                            fetchHomolog(resultData.TokenResposta),\r\n                            fetchCartItems(resultData.TokenResposta)\r\n                        ])\r\n                            .then(resultFetch => {\r\n                                setItemSession('_fornecedores', JSON.stringify(resultFetch[0].data.Data.Dados))\r\n                                setItemSession('_categorias', JSON.stringify(resultFetch[1].data.Data.Dados))\r\n                                setItemSession('_versao', JSON.stringify(resultFetch[2].data.Data))\r\n                                setItemSession('_homolog', JSON.stringify(resultFetch[3].data.Data))\r\n                                setItemSession('_carrinho', JSON.stringify(resultFetch[4].data.Data))\r\n\r\n                                window.location.href = process.env.REACT_APP_BASE_URL\r\n                            })\r\n                    } else {\r\n                        latestProps.current.history.push('/unauthorized');\r\n                    };\r\n\r\n                })\r\n                .catch(error => {\r\n                    latestProps.current.history.push('/unauthorized');\r\n                })\r\n        }\r\n\r\n        var ambiente = process.env.REACT_APP_API_EMPRESA;\r\n\t\tvar isHomolog = ambiente.toLowerCase().includes(\"Teste\") ? true : false;\r\n\t\t\r\n        var myCookie = Cookies.get('_register_' + isHomolog);\r\n        let device = myCookie;\r\n\r\n        if (!myCookie || device == null || device == '' || device == 0) {\r\n            const browser = browserName + ' ' + browserVersion + ' ' + deviceType;\r\n            const so = osName + ' ' + osVersion;\r\n            const serialNumber = uuidv4();\r\n            const uniqueKey = uuidv4();\r\n\r\n            postDevice(browser, so, uniqueKey, serialNumber)\r\n                .then(result => {\r\n                    Cookies.remove('_register_' + isHomolog);\r\n                    Cookies.set('_register_' + isHomolog, result.data.Data.Retorno, { expires: 3650 });\r\n\t\t\t\t\treturn result.data.Data.Retorno;\r\n                })\r\n                .then(result => doLogin(result));\r\n        } else {\r\n            doLogin(device);\r\n        }\r\n    }\r\n\r\n\r\n    // se est치 logado, direciona para Home\r\n    if (getItemSession('_token')) {\r\n        fetchSession()\r\n            .then(result => {\r\n                if (result.CodigoInterno != 4) {\r\n                    window.location.href = process.env.REACT_APP_BASE_URL\r\n                } else {\r\n                    localStorage.clear();\r\n                }\r\n            })\r\n        return null;\r\n    }\r\n\r\n    \r\n    return (\r\n        <section className=\"conteudo_interno container\" id=\"painellogin\">\r\n            \r\n            <div>\r\n                \r\n                <center><img src='http://iis3.blink.com.br:13162/Images/logo_login.png'/></center>\r\n                <form>\r\n                    <div className=\"form-group text-left\">\r\n                        <label htmlFor=\"exampleInputEmail1\">Usu치rio</label>\r\n                        <div class=\"input-group-prepend\">\r\n                            <div class=\"iconlogin\">\r\n                                <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" class=\"bi bi-people\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                                    <path fill-rule=\"evenodd\" d=\"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.995-.944v-.002.002zM7.022 13h7.956a.274.274 0 0 0 .014-.002l.008-.002c-.002-.264-.167-1.03-.76-1.72C13.688 10.629 12.718 10 11 10c-1.717 0-2.687.63-3.24 1.276-.593.69-.759 1.457-.76 1.72a1.05 1.05 0 0 0 .022.004zm7.973.056v-.002.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10c-1.668.02-2.615.64-3.16 1.276C1.163 11.97 1 12.739 1 13h3c0-1.045.323-2.086.92-3zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z\"/>\r\n                                </svg>\r\n                            </div>\r\n                            \r\n                            <input type=\"text\"\r\n                                className=\"form-control\"\r\n                                id=\"usuario\"\r\n                                aria-describedby=\"usuarioHelp\"\r\n                                placeholder=\"CNPJ\"\r\n                                value={state.usuario}\r\n                                onChange={handleChange}\r\n                                \r\n                            />\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div className=\"form-group text-left\">\r\n                        <label htmlFor=\"exampleInputPassword1\">Senha</label>\r\n                        <div class=\"input-group-prepend\">\r\n                            <div class=\"iconlogin\">\r\n                                <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" class=\"bi bi-key\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                                    <path fill-rule=\"evenodd\" d=\"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z\"/>\r\n                                    <path d=\"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\"/>\r\n                                </svg>\r\n                            </div>\r\n\r\n                            <input type=\"password\"\r\n                                className=\"form-control\"\r\n                                id=\"senha\"\r\n                                placeholder=\"C칩digo\"\r\n                                value={state.senha}\r\n                                onChange={handleChange}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-check\">\r\n                    </div>\r\n                    <button\r\n                        type=\"submit\"\r\n                        id=\"acessarlogin\"\r\n                        className=\"btn btn-primary\"\r\n                        onClick={handleSubmitClick}\r\n                        disabled={loading}\r\n                    >\r\n                        {loading && <i className=\"fa fa-refresh fa-spin\"></i>}\r\n                        Acessar\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}